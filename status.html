<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI-Native Computing - Status</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #1a1a1a;
      font-family: 'JetBrains Mono', Consolas, monospace;
      color: #e0e0e0;
    }

    canvas {
      display: block;
    }

    #overlay {
      position: absolute;
      top: 1rem;
      left: 1rem;
      background: rgba(28, 28, 28, 0.85);
      color: #ffffff;
      padding: 0.75rem 1.25rem;
      border: 1px solid #2c2c2c;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 500;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
      transition: background 0.3s ease;
    }

    #commits {
      position: absolute;
      bottom: 1rem;
      left: 1rem;
      background: rgba(30, 30, 30, 0.9);
      color: #ccc;
      font-size: 0.85rem;
      padding: 1rem;
      border-radius: 6px;
      line-height: 1.6;
      max-width: 700px;
      max-height: 40vh;
      overflow-y: auto;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      border: 1px solid #2a2a2a;
      display: none;
    }

      #commits a {
        color: #79dfff;
        text-decoration: none;
        font-weight: 500;
      }

        #commits a:hover {
          color: #f9d65d;
        }

    .commit-entry {
      margin-bottom: 0.8em;
      border-bottom: 1px solid #333;
      padding-bottom: 0.6em;
    }

      .commit-entry:last-child {
        border-bottom: none;
      }

      .commit-entry img {
        border-radius: 50%;
        vertical-align: middle;
        margin-left: 4px;
      }

    code {
      background: #2a2a2a;
      color: #ffeebb;
      padding: 0.15rem 0.4rem;
      border-radius: 4px;
      font-size: 0.9rem;
    }
  </style>

</head>
<body>
  <div id="overlay">üõ†Ô∏è BUILDING...</div>

  <div id="commits">
    üîÑ Loading commit history...
  </div>



  <!-- Three.js from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

  <script>

    setTimeout(() => location.reload(), 15000); // 15000ms is 15 seconds

    // Setup
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x111111);

    const camera = new THREE.PerspectiveCamera(
      75, window.innerWidth / window.innerHeight, 0.1, 1000
    );
    camera.position.z = 5;

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Lighting
    const ambient = new THREE.AmbientLight(0x404040);
    scene.add(ambient);

    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(3, 2, 1);
    scene.add(light);

    // Cube
    const geometry = new THREE.BoxGeometry(1, 1, 1);
    const material = new THREE.MeshStandardMaterial({ color: 0x00eedd });
    const cube = new THREE.Mesh(geometry, material);
    scene.add(cube);

    // Build flag
    let loading = true;
    let t = 0;

    // Animate
    function animate() {
      requestAnimationFrame(animate);

      if (loading) {
        cube.rotation.x += 0.01;
        cube.rotation.y += 0.01;
        t += 0.01;
        camera.position.x = Math.sin(t) * 5;
        camera.position.z = Math.cos(t) * 5;
        camera.lookAt(cube.position);
        renderer.render(scene, camera);
        return;
      }

      // After loading: scene has changed
      renderer.render(scene, camera);
    }

    animate();

    // Resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Simulate build process
    setTimeout(() => {
      loading = false;

      // Update overlay
      const overlay = document.getElementById("overlay");
      overlay.innerText = "‚úîÔ∏è Deployed from Notepad";

      // Show commits panel
      document.getElementById("commits").style.display = "block";

      // Remove cube from scene
      scene.remove(cube);

      // (Optional: update background or add new scene here)
    }, 2000); // 1000ms is 1 second

    // GitHub Commits API
    // GitHub Commits API
    fetch('https://api.github.com/repos/ai-native-computing/lab/commits')
      .then(res => res.json())
      .then(commits => {
        const commitList = commits.slice(0, 5).map(commit => {
          const sha = commit.sha.substring(0, 7);
          const fullSha = commit.sha;
          const msg = commit.commit.message.split('\n')[0];
          const author = commit.commit.author.name;
          const authorAvatar = commit.author?.avatar_url;
          const authorUrl = commit.author?.html_url;
          const timestamp = new Date(commit.commit.author.date);
          const timeAgo = timeSince(timestamp);

          return `
          <div style="margin-bottom: 0.5em;">
            <a href="https://github.com/ai-native-computing/lab/commit/${fullSha}" target="_blank" style="text-decoration: none; color: inherit;" title="${msg}\n${timestamp}">
              <code style="font-weight: bold;">${sha}</code>

              ‚Äî ${highlightCommitMessage(msg)}
              <span title="${timestamp.toLocaleString()}">üïí ${timeAgo}</span>
            </a>
            ${authorAvatar ? `<a href="${authorUrl}" target="_blank"><img src="${authorAvatar}" alt="${author}" width="16" height="16" style="border-radius: 50%; vertical-align: middle; margin-left: 4px;" title="${author}"></a>` : ''}
          </div>
        `;
        }).join('');

        document.getElementById("commits").innerHTML = `
        <strong>üì¶ Latest Deploys:</strong><br>${commitList}
      `;
      })
      .catch(err => {
        document.getElementById("commits").innerText = "‚ö†Ô∏è Could not load commits.";
        console.error("GitHub API error:", err);
      });

    // Helper function: relative time
    function timeSince(date) {
      const seconds = Math.floor((new Date() - date) / 1000);
      const intervals = [
        [31536000, 'y'], [2592000, 'mo'], [86400, 'd'],
        [3600, 'h'], [60, 'm'], [1, 's']
      ];
      for (const [secs, label] of intervals) {
        const count = Math.floor(seconds / secs);
        if (count >= 1) return `${count}${label} ago`;
      }
      return 'just now';
    }

    // Helper function: tag highlight
    function highlightCommitMessage(msg) {
      const tag = msg.toLowerCase().split(' ')[0];
      if (tag.includes('fix')) return `üõ†Ô∏è <span style="color:#f28b82;">${msg}</span>`;
      if (tag.includes('deploy')) return `üöÄ <span style="color:#64b5f6;">${msg}</span>`;
      if (tag.includes('feature')) return `‚ú® <span style="color:#81c784;">${msg}</span>`;
      return msg;
    }


  </script>
</body>
</html>
