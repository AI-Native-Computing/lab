<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Reflex Blog</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #eee;
      margin: 2rem;
    }
    h1 {
      color: #f6c944;
    }
    .post {
      margin-bottom: 1rem;
      padding: 0.5rem;
      border-left: 3px solid #444;
    }
    .post a {
      color: #80d4ff;
      text-decoration: none;
      font-weight: bold;
    }
    .post small {
      display: block;
      color: #aaa;
    }
  </style>
</head>
<body>

<h1>ðŸ“˜ Reflex Blog</h1>
<div id="blog-list">Loading blog posts...</div>

<script>
const blogFiles = [
  'first-post.md',
  // Add more .md filenames here
];

async function fetchMetadata(filename) {
  const res = await fetch(`blog/${filename}`);
  const text = await res.text();

  const metaMatch = text.match(/^---([\s\S]*?)---/);
  if (!metaMatch) return null;

  const metaLines = metaMatch[1].trim().split('\n');
  const meta = {};
  metaLines.forEach(line => {
    const [key, ...rest] = line.split(':');
    meta[key.trim()] = rest.join(':').trim();
  });

  meta.slug = filename.replace(/\.md$/, '');
  return meta;
}

async function loadBlogIndex() {
  const listEl = document.getElementById('blog-list');
  const posts = [];

  for (const file of blogFiles) {
    const meta = await fetchMetadata(file);
    if (meta) posts.push(meta);
  }

  // Sort newest first
  posts.sort((a, b) => new Date(b.date) - new Date(a.date));

  listEl.innerHTML = posts.map(post => `
    <div class="post">
      <a href="blog/${post.slug}.md">${post.title}</a>
      <small>${post.date}</small>
      <p>${post.description}</p>
    </div>
  `).join('');
}

loadBlogIndex();
</script>

</body>
</html>
